#! /usr/bin/env python

from helpers import cm_libcloud
import sys, os

def main():
    cm_libcloud.dependency_check()
   
    # Get a list of images and write it out
    try:

        # Grab the file to write to.
        with open(os.path.expanduser('~/config/image_options'), 'w') as f:
            f.write('# Automatically generated by the update_options python script' + '\n')
            # Get the possible images and write them into the file.
            for image in cm_libcloud.get_images():
                f.write(image.name.replace('=', '\\=') + '=' + image.name + '\n')
            print 'Wrote: ', os.path.expanduser('~/config/image_options')
        f.close()
        

    except:
        sys.exit(1)
        
    # Get a list of sizes and write it out
    try:
        # Grab the file to write to.
        with open(os.path.expanduser('~/config/size_options'), 'w') as f:
            f.write('# Automatically generated by the update_options python script' + '\n')
            # Get the possible images and write them into the file.
            for size in cm_libcloud.get_sizes():
                f.write(size.name.replace('=', '\\=') + '=' + size.name + '\n')
            print 'Wrote: ', os.path.expanduser('~/config/size_options')
        f.close()
    except:
        sys.exit(1)



if __name__ == "__main__":
    main()