#! /usr/bin/env python

from helpers import cm_libcloud
import sys, os

def main():
    cm_libcloud.dependency_check()
   
    try:
        # Grab the file to write to.
        with open(os.path.expanduser('~/config/rackspace_options'), 'w') as f:
            f.write('# Automatically generated by the update_options python script' + '\n')
            # Get the possible images and write them into the file.
            image_names = []
            for image in cm_libcloud.get_images():
                image_names.append(image.name)
            f.write('images=' + ','.join(image_names) + '\n')
            
            # Get the possible images and write them into the file.
            size_names = []
            for size in cm_libcloud.get_sizes():
                size_names.append(size.name)
            f.write('sizes=' + ','.join(size_names) + '\n')
            
            print 'Wrote: ', os.path.expanduser('~/config/rackspace_options')
        f.close()
    except IOError:
        sys.exit(1)



if __name__ == "__main__":
    main()